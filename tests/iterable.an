import "tests/vec.an"

type VecIter = i32* elem, u32 elems_remaining

ext Vec : Iterable
    fun into_iter: Vec v -> VecIter
        VecIter(v._data, v.len)


ext VecIter : Iterator
    fun unwrap: VecIter v =
        @v.elem

    fun next: VecIter v =
        VecIter(i32*(u64(v.elem) + 4), v.elems_remaining-1)

    fun has_next: VecIter v =
        v.elems_remaining > 0


var v = Vec()
push v 1
push v 1
push v 2
push v 3
push v 5
push v 8
push v 13
push v 21

for i in v do
    print i
